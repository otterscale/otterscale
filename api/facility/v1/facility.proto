edition = "2023";

package otterscale.facility.v1;

import "api/annotations.proto";
import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";

option go_package = "github.com/otterscale/otterscale/api/facility/v1;pb";

service FacilityService {
  rpc ListFacilities(ListFacilitiesRequest) returns (ListFacilitiesResponse) {
    option (otterscale.api.feature) = {
      name: "fac-general"
    };
  };

  rpc ResolveFacilityUnitErrors(ResolveFacilityUnitErrorsRequest) returns (google.protobuf.Empty) {
    option (otterscale.api.feature) = {
      name: "fac-general"
    };
  };
}

message Facility {
  message Charm {
    message Base {
      string name = 1;
      string channel = 2;
      string architecture = 3;
    }
    message Artifact {
      string channel = 1;
      int64 revision = 2;
      string version = 11;
      repeated Base bases = 12;
      google.protobuf.Timestamp created_at = 21;
    }
    string id = 1;
    string type = 2;
    string name = 3;
    bool verified = 4;
    string title = 11;
    string summary = 12;
    string icon = 13;
    string description = 14;
    repeated string categories = 15;
    repeated string deployable_on = 16;
    string publisher = 17;
    string license = 18;
    string store_url = 21;
    string website = 22;
    Artifact default_artifact = 31;
  }
  message Action {
    string name = 1;
    string description = 2;
  }
  message Status {
    string state = 1;
    string details = 2;
    google.protobuf.Timestamp created_at = 3;
  }
  message Unit {
    string name = 1;
    Status agent_status = 2;
    Status workload_status = 3;
    bool leader = 4;
    string machine_id = 11;
    string ip_address = 12;
    repeated string ports = 13;
    string hostname = 14;
    string charm_name = 21;
    string version = 22;
    repeated Unit subordinates = 31;
  }
  string name = 1;
  Status status = 2;
  string charm_name = 11;
  string version = 12;
  int64 revision = 13;
  string channel = 14;
  reserved 21;
  repeated Unit units = 31;
}

message ListFacilitiesRequest {
  string scope = 1;
}

message ListFacilitiesResponse {
  repeated Facility facilities = 1;
}

message ResolveFacilityUnitErrorsRequest {
  string scope = 1;
  string unit_name = 2;
}
